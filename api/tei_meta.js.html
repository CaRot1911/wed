<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: modes/generic/metas/tei_meta.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
    <link type="text/css" rel="stylesheet" href="styles/wed.css">
</head>

<body>


<div id="main">

    <h1 class="page-title">Source: modes/generic/metas/tei_meta.js</h1>

    


    
    <section>
        <article>
            <pre class="prettyprint source"><code>/**
 * @module modes/generic/metas/tei_meta
 * @desc The main module for the generic mode.
 * @author Louis-Dominique Dubeau
 * @license MPL 2.0
 * @copyright 2013 Mangalam Research Center for Buddhist Languages
 */
define(/** @lends module:modes/generic/metas/tei_meta */
function (require, exports, module) {
'use strict';

var $ = require("jquery");
var oop = require("wed/oop");
var util = require("wed/util");
var GenericMeta = require("wed/modes/generic/generic_meta").Meta;

/**
 * @classdesc Meta-information for a generic TEI schema.
 *
 * @extends module:modes/generic/generic_meta~Meta
 *
 * @constructor
 */
function TeiMeta() {
}

oop.inherit(TeiMeta, GenericMeta);

TeiMeta.prototype.isInline = function (node) {
    var $node = $(node);
    // We need to normalize the name to fit the names we have below.
    var original_name = util.getOriginalName(node);
    var parts = original_name.split(":");
    // XXX this is taking a shortcut. We should instead find the
    // namespace of the node and convert it to an appropriate prefix
    // to use below.
    if (parts.length === 1) {
        parts[1] = parts[0];
        parts[0] = "tei";
    }
    var name = parts.join(":");

    // The implementation here is a partial implementation of the
    // function found in common2/functions.xsl among the TEI
    // stylesheets.

    // Not implemented: &lt;xsl:when test="not(self::*)">true&lt;/xsl:when>
    // &lt;xsl:when test="contains(@rend,'inline') and not(tei:p or
    // tei:l)">true&lt;/xsl:when> &lt;xsl:when
    // test="self::tei:note[@place='display']">false&lt;/xsl:when>
    // &lt;xsl:when
    // test="self::tei:note[tei:isEndNote(.)]">true&lt;/xsl:when>
    // &lt;xsl:when
    // test="self::tei:note[tei:isFootNote(.)]">true&lt;/xsl:when>
    // &lt;xsl:when test="@rend='display'
    // or @rend='block'">false&lt;/xsl:when> &lt;xsl:when test="tei:table or
    // tei:figure or tei:list or tei:lg or tei:q/tei:l or tei:l or
    // tei:p or tei:biblStruct or tei:sp or
    // tei:floatingText">false&lt;/xsl:when> &lt;xsl:when
    // test="parent::tei:div">false&lt;/xsl:when> &lt;xsl:when
    // test="parent::tei:titlePage">false&lt;/xsl:when> &lt;xsl:when
    // test="self::tei:cit[not(@rend)]">true&lt;/xsl:when> &lt;xsl:when
    // test="parent::tei:cit[@rend='display']">false&lt;/xsl:when>
    // &lt;xsl:when test="parent::tei:cit and (tei:p or
    // tei:l)">false&lt;/xsl:when> &lt;xsl:when test="parent::tei:cit and
    // parent::cit/tei:bibl">false&lt;/xsl:when> &lt;xsl:when
    // test="parent::tei:body">false&lt;/xsl:when> &lt;xsl:when
    // test="parent::tei:titlePage">false&lt;/xsl:when> &lt;xsl:when
    // test="self::tei:docAuthor and
    // parent::tei:byline">true&lt;/xsl:when> &lt;xsl:when
    // test="self::tei:note[tei:cit/tei:bibl]">false&lt;/xsl:when>
    // &lt;xsl:when
    // test="self::tei:note[parent::tei:biblStruct]">true&lt;/xsl:when>
    // &lt;xsl:when
    // test="self::tei:note[parent::tei:bibl]">true&lt;/xsl:when> End not
    // implemented.


    // &lt;xsl:when test="self::tei:note">true&lt;/xsl:when>
    // &lt;xsl:when test="self::mml:math">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:abbr">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:affiliation">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:altIdentifier">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:analytic">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:add">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:am">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:att">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:author">true&lt;/xsl:when>
    switch (name) {
    case "tei:note":
    case "mml:math":
    case "tei:abbr":
    case "tei:affiliation":
    case "tei:altIdentifier":
    case "tei:analytic":
    case "tei:add":
    case "tei:am":
    case "tei:att":
    case "tei:author":
        return true;
    }

    // Not implemented: &lt;xsl:when test="self::tei:bibl and not
    // (tei:is-inline(preceding-sibling::*[1]))">false&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:bibl and not
    // (parent::tei:listBibl)">true&lt;/xsl:when> End not implemented.

    // &lt;xsl:when test="self::tei:biblScope">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:br">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:byline">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:c">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:caesura">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:choice">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:code">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:collection">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:country">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:damage">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:date">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:del">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:depth">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:dim">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:dimensions">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:editor">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:editionStmt">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:emph">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:ex">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:expan">true&lt;/xsl:when>
    switch(name) {
    case "tei:biblScope":
    case "tei:br":
    case "tei:byline":
    case "tei:c":
    case "tei:caesura":
    case "tei:choice":
    case "tei:code":
    case "tei:collection":
    case "tei:country":
    case "tei:damage":
    case "tei:date":
    case "tei:del":
    case "tei:depth":
    case "tei:dim":
    case "tei:dimensions":
    case "tei:editor":
    case "tei:editionStmt":
    case "tei:emph":
    case "tei:ex":
    case "tei:expan":
        return true;
    }

    // Not implemented:
    // &lt;xsl:when test="self::tei:figure[@place='inline']">true&lt;/xsl:when>
    // End Not implemented.

    // &lt;xsl:when test="self::tei:figure">false&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:floatingText">false&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:foreign">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:forename">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:gap">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:genName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:geogName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:gi">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:gloss">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:graphic">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:height">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:hi[not(w:*)]">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:ident">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:idno">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:imprint">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:institution">true&lt;/xsl:when>
    switch(name) {
    case "tei:figure":
    case "tei:floatingText":
        return false;
    case "tei:foreign":
    case "tei:forename":
    case "tei:gap":
    case "tei:genName":
    case "tei:geogName":
    case "tei:gi":
    case "tei:gloss":
    case "tei:graphic":
    case "tei:height":
    case "tei:hi":
        // The original test was:
        // &lt;xsl:when test="self::tei:hi[not(w:*)]">true&lt;/xsl:when>
    case "tei:ident":
    case "tei:idno":
    case "tei:imprint":
    case "tei:institution":
        return true;
    }

    // &lt;xsl:when test="self::tei:list">false&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:locus">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:mentioned">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:monogr">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:series">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:msName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:name">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:num">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:orgName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:orig">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:origDate">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:origPlace">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:pc">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:persName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:placeName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:ptr">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:publisher">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:pubPlace">true&lt;/xsl:when>

    switch(name) {
    case "tei:list":
        return false;
    case "tei:locus":
    case "tei:mentioned":
    case "tei:monogr":
    case "tei:series":
    case "tei:msName":
    case "tei:name":
    case "tei:num":
    case "tei:orgName":
    case "tei:orig":
    case "tei:origDate":
    case "tei:origPlace":
    case "tei:pc":
    case "tei:persName":
    case "tei:placeName":
    case "tei:ptr":
    case "tei:publisher":
    case "tei:pubPlace":
        return true;
    }

    // Not implemented: &lt;xsl:when test="self::tei:lb or
    // self::pb">true&lt;/xsl:when> &lt;xsl:when test="self::tei:quote and
    // tei:lb">false&lt;/xsl:when> &lt;xsl:when test="self::tei:quote and
    // $autoBlockQuote='true' and
    // string-length(.)&gt;$autoBlockQuoteLength">false&lt;/xsl:when> End
    // not implemented.

    // &lt;xsl:when test="self::tei:q">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:quote">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:ref">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:region">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:repository">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:roleName">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:rubric">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:said">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:seg">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:sic">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:settlement">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:soCalled">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:summary">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:supplied">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:surname">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:tag">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:term">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:textLang">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:title">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:unclear">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:val">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:width">true&lt;/xsl:when>
    // &lt;xsl:when test="self::tei:dynamicContent">true&lt;/xsl:when>
    // &lt;xsl:when test="self::w:drawing">true&lt;/xsl:when>
    // &lt;xsl:when test="self::m:oMath">true&lt;/xsl:when>
    switch(name) {
    case "tei:q":
    case "tei:quote":
    case "tei:ref":
    case "tei:region":
    case "tei:repository":
    case "tei:roleName":
    case "tei:rubric":
    case "tei:said":
    case "tei:seg":
    case "tei:sic":
    case "tei:settlement":
    case "tei:soCalled":
    case "tei:summary":
    case "tei:supplied":
    case "tei:surname":
    case "tei:tag":
    case "tei:term":
    case "tei:textLang":
    case "tei:title":
    case "tei:unclear":
    case "tei:val":
    case "tei:width":
    case "tei:dynamicContent":
    case "w:drawing":
    case "m:oMath":
        return true;
    }

    // Not implemented: &lt;xsl:when
    // test="parent::tei:note[tei:isEndNote(.)]">false&lt;/xsl:when>
    // &lt;xsl:when test="empty($element/..)">false&lt;/xsl:when> &lt;xsl:when
    // test="not(self::tei:p) and
    // tei:is-inline($element/..)">true&lt;/xsl:when> End not
    // implemented.
    return false;
};

TeiMeta.prototype.getNamespaceMappings = function () {
    return {
    "tei": "http://www.tei-c.org/ns/1.0",
    "xml": "http://www.w3.org/XML/1998/namespace",
    "": "http://www.tei-c.org/ns/1.0"
    };
};

exports.Meta = TeiMeta;

});

//  LocalWords:  oMath dynamicContent textLang soCalled roleName seg
//  LocalWords:  pubPlace ptr placeName persName pc origPlace orgName
//  LocalWords:  origDate num msName monogr Mangalam metas tei Dubeau
//  LocalWords:  MPL jquery oop util namespace stylesheets isEndNote
//  LocalWords:  isFootNote xsl biblStruct titlePage floatingText sp
//  LocalWords:  bibl docAuthor mml altIdentifier listBibl biblScope
//  LocalWords:  editionStmt att br del emph expan genName geogName
//  LocalWords:  gi ident idno
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Index</a></h2><h3>Modules</h3><ul><li><a href="findandself.html">findandself</a></li><li><a href="module-action.html">action</a></li><li><a href="module-decorator.html">decorator</a></li><li><a href="module-domlistener.html">domlistener</a></li><li><a href="module-domutil.html">domutil</a></li><li><a href="module-exceptions.html">exceptions</a></li><li><a href="context_menu.html">gui/context_menu</a></li><li><a href="modal.html">gui/modal</a></li><li><a href="module-gui_updater.html">gui_updater</a></li><li><a href="module-input_trigger.html">input_trigger</a></li><li><a href="module-input_trigger_factory.html">input_trigger_factory</a></li><li><a href="module-jqutil.html">jqutil</a></li><li><a href="module-key.html">key</a></li><li><a href="module-key_constants.html">key_constants</a></li><li><a href="conditioned.html">lib/conditioned</a></li><li><a href="simple_event_emitter.html">lib/simple_event_emitter</a></li><li><a href="module-log.html">log</a></li><li><a href="module-mode.html">mode</a></li><li><a href="generic.html">modes/generic/generic</a></li><li><a href="generic_decorator.html">modes/generic/generic_decorator</a></li><li><a href="generic_meta.html">modes/generic/generic_meta</a></li><li><a href="generic_tr.html">modes/generic/generic_tr</a></li><li><a href="tei_meta.html">modes/generic/metas/tei_meta</a></li><li><a href="test_decorator.html">modes/test/test_decorator</a></li><li><a href="test_mode.html">modes/test/test_mode</a></li><li><a href="module-mutation_domlistener.html">mutation_domlistener</a></li><li><a href="module-onbeforeunload.html">onbeforeunload</a></li><li><a href="module-onerror.html">onerror</a></li><li><a href="module-oop.html">oop</a></li><li><a href="module-refman.html">refman</a></li><li><a href="module-saver.html">saver</a></li><li><a href="module-transformation.html">transformation</a></li><li><a href="module-tree_updater.html">tree_updater</a></li><li><a href="module-undo.html">undo</a></li><li><a href="module-undo_recorder.html">undo_recorder</a></li><li><a href="module-updater_domlistener.html">updater_domlistener</a></li><li><a href="module-util.html">util</a></li><li><a href="module-validator.html">validator</a></li><li><a href="module-wed.html">wed</a></li><li><a href="module-wundo.html">wundo</a></li></ul><h3>Classes</h3><ul><li><a href="module-action-Action.html">Action</a></li><li><a href="module-decorator-Decorator.html">Decorator</a></li><li><a href="module-domlistener-Listener.html">Listener</a></li><li><a href="module-exceptions-AbortTransformationException.html">AbortTransformationException</a></li><li><a href="context_menu-ContextMenu.html">ContextMenu</a></li><li><a href="modal-Modal.html">Modal</a></li><li><a href="module-gui_updater-GUIUpdater.html">GUIUpdater</a></li><li><a href="module-input_trigger-InputTrigger.html">InputTrigger</a></li><li><a href="module-key-Key.html">Key</a></li><li><a href="conditioned-Conditioned.html">Conditioned</a></li><li><a href="simple_event_emitter-SimpleEventEmitter.html">SimpleEventEmitter</a></li><li><a href="module-log-Handled.html">Handled</a></li><li><a href="generic_decorator-GenericDecorator.html">GenericDecorator</a></li><li><a href="generic_meta-Meta.html">Meta</a></li><li><a href="generic_tr-Registry.html">Registry</a></li><li><a href="generic-Mode.html">Mode</a></li><li><a href="tei_meta-TeiMeta.html">TeiMeta</a></li><li><a href="test_decorator-TestDecorator.html">TestDecorator</a></li><li><a href="test_mode-TestMode.html">TestMode</a></li><li><a href="module-mode-Mode.html">Mode</a></li><li><a href="module-mutation_domlistener-Listener.html">Listener</a></li><li><a href="module-refman-ReferenceManager.html">ReferenceManager</a></li><li><a href="module-refman-SenseReferenceManager.html">SenseReferenceManager</a></li><li><a href="module-saver-Saver.html">Saver</a></li><li><a href="module-transformation-Transformation.html">Transformation</a></li><li><a href="module-transformation-TransformationRegistry.html">TransformationRegistry</a></li><li><a href="module-tree_updater-TreeUpdater.html">TreeUpdater</a></li><li><a href="module-undo_recorder-UndoRecorder.html">UndoRecorder</a></li><li><a href="module-undo-Undo.html">Undo</a></li><li><a href="module-undo-UndoGroup.html">UndoGroup</a></li><li><a href="module-undo-UndoList.html">UndoList</a></li><li><a href="module-updater_domlistener-Listener.html">Listener</a></li><li><a href="module-validator-EventIndexException.html">EventIndexException</a></li><li><a href="module-validator-Validator.html">Validator</a></li><li><a href="module-wed-Editor.html">Editor</a></li><li><a href="module-wundo-MarkerUndo.html">MarkerUndo</a></li><li><a href="module-wundo-TextUndoGroup.html">TextUndoGroup</a></li><li><a href="module-wundo-UndoGroup.html">UndoGroup</a></li></ul><h3>Events</h3><ul><li><a href="module-action-Action.html#event:disabled">disabled</a></li><li><a href="module-action-Action.html#event:enabled">enabled</a></li><li><a href="module-gui_updater-GUIUpdater.html#event:deleteNode">deleteNode</a></li><li><a href="module-gui_updater-GUIUpdater.html#event:insertNodeAt">insertNodeAt</a></li><li><a href="module-gui_updater-GUIUpdater.html#event:setTextNodeValue">setTextNodeValue</a></li><li><a href="module-transformation-Transformation.html#event:disabled">disabled</a></li><li><a href="module-transformation-Transformation.html#event:enabled">enabled</a></li><li><a href="module-tree_updater-TreeUpdater.html#event:deleteNode">deleteNode</a></li><li><a href="module-tree_updater-TreeUpdater.html#event:insertNodeAt">insertNodeAt</a></li><li><a href="module-tree_updater-TreeUpdater.html#event:setTextNodeValue">setTextNodeValue</a></li><li><a href="module-validator-Validator.html#event:error">error</a></li><li><a href="module-validator-Validator.html#event:reset-errors">reset-errors</a></li><li><a href="module-validator-Validator.html#event:state-update">state-update</a></li></ul>
</nav>

<br clear="both">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.2.2</a> on Wed Nov 13 2013 14:29:37 GMT-0500 (EST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
