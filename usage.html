

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Introduction &mdash; Wed 0.10.0 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.10.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Wed 0.10.0 documentation" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="index.html">Wed 0.10.0 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>Wed is a web-based editor that assists users in editing XML documents
according to their own Relax NG schema. It runs in a web browser. It
is alpha software. We aim to make it extensible, but the API is likely
to change until we hit version 1.0.0.</p>
<p>Known limitations:</p>
<ul class="simple">
<li>Wed currently only understands a subset of Relax NG (through the
<a class="reference external" href="https://github.com/mangalam-research/salve/">salve</a> package).</li>
<li>Wed does not currently support editing attributes in a
generic way <em>as attributes</em>. The functionality just has not been
implemented <strong>yet</strong> because wed is developed in the context of a
project where all attributes are set by software or are edited
through domain-specific abstractions rather than directly, as
attributes. Other features are more pressing.</li>
<li>Eventually the plan is to handle XML namespace
changes completely, and there is incipient code to deal with this; for now
the safe thing to do if you have a file using multiple namespaces is
to declare them once and for all on the top element, and never
change them throughout the document. Otherwise, problems are likely.</li>
<li>We&#8217;ve not tested a setup in which more than one wed instance appears
on the same page.</li>
<li>Keyboard navigation in contextual menus works. However, if the mouse
is hovering over menu items, two items will be highlighted at once,
which may be confusing. This seems to be a limitation of CSS which
Bootstrap does nothing to deal with. (One element may be in the
focused state (keyboard) while another is in the hover state.)</li>
<li>Wed does not work with RTL scripts. There no inherent reason wed
could not support them but the project for which it is developed
currently does not need support for RTL scripts. So no resources
have been expended towards supporting this.</li>
<li>Wed is not internationalized. Although the contents of a document
could be in any language, wed&#8217;s UI is in English. Again, there is no
inherent reason wed could not support other languages for the
UI. The project for which it is developed currently does not need
support for other languages, hence this state of affairs.</li>
<li>See also <a class="reference internal" href="#browser-requirements">Browser Requirements</a>.</li>
</ul>
<p>Known bugs:</p>
<ul class="simple">
<li>Firefox: Sometimes a caret moved to the end of a bit of text
disappears. There does not seem to be any rhyme or reason for it. It
is probably a Firefox bug. At any rate, wed does not currently
compensate for it. So you may see your caret disappear, but it is
still there, waiting for you to type text.</li>
</ul>
</div>
<div class="section" id="browser-requirements">
<h1>Browser Requirements<a class="headerlink" href="#browser-requirements" title="Permalink to this headline">¶</a></h1>
<p>While potential users of wed should definitely heed the warnings
below, we have started testing wed on SauceLab&#8217;s server under their
OpenSauce program so support for various platforms should improve.</p>
<p>Wed is primarily developed using a recent version of Chrome (version
29; versions 26, 27 and 28 have also been used earlier) and a recent
version of Firefox (version 24; versions 20, 21, 22 and 23 have also
been used earlier) for testing. Ideally wed should work with recent
versions of other browsers but since it is not routinely tested with
those browsers there may be bugs specific to running wed in those
browsers. File an issue in github if you find a problem with IE 9 or
higher or a relatively recent other kind of desktop browser or
(obviously) with the browsers used for testing wed.  Due to a lack of
development resources, the following items are unlikely to ever be
supported, in decreasing order of likelihood:</p>
<ul class="simple">
<li>Browsers for phones and tablets.</li>
<li>Versions of Chrome and Firefox older than those mentioned above.</li>
<li>Versions of IE older than 9.</li>
<li>Antique browsers.</li>
<li>Oddball browsers or other software or hardware systems that present
web pages.</li>
<li>Operating systems or browsers no longer supported by their own
vendors.</li>
</ul>
<p>Wed does not require any specific OS facilities. However, keyboard
support on Macs in JavaScript has some peculiarities. Unfortunately,
since this project has not so far benefited from access to a Mac for
testing, users of Mac-based browsers may experience issues that do not
exist on other platforms. File an issue in github if you find a
problem with a relatively recent Mac-based browser.</p>
</div>
<div class="section" id="dependencies">
<h1>Dependencies<a class="headerlink" href="#dependencies" title="Permalink to this headline">¶</a></h1>
<p>Wed is packaged as a RequireJS module. So to use it in a browser
environment, you need to first load RequireJS and pass to it a
configuration that will allow it to find wed&#8217;s code. An example of
such configuration, which allows running the browser-dependent test
suite, is located in <a class="reference external" href="config/requirejs-config-dev.js">config/requirejs-config-dev.js</a>.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you want to change this configuration for
experimentation or to match your local setup, please copy
it to the <tt class="docutils literal"><span class="pre">&lt;local_config&gt;</span></tt> directory and edit it
<em>there</em>. This directory is not tracked by git.</p>
</div>
<p>In all cases Wed requires the following packages:</p>
<ul class="simple">
<li>jquery 1.9.1 or higher</li>
<li>Bootstrap version 3.0.0 or a later version in the version 3 series.</li>
<li><a class="reference external" href="https://github.com/mangalam-research/salve/">salve</a></li>
<li>rangy, together with its <tt class="docutils literal"><span class="pre">selectionsaverestore</span></tt> module.</li>
<li>bootstrap-growl</li>
</ul>
<p>Loading wed in a Node.js environment requires installing the
following node package:</p>
<ul class="simple">
<li>node-amd-loader</li>
</ul>
<p>Building wed <strong>additionally</strong> requires the following node packages:</p>
<ul class="simple">
<li>less</li>
</ul>
<p>Since wed is not yet distributed in a pre-compiled form, you
effectively need these packages installed if you
want to use wed because you have to build it first.</p>
<p>Building wed&#8217;s documentation <strong>additionally</strong> requires the following
packages:</p>
<ul class="simple">
<li>jsdoc3</li>
<li>rst2html</li>
<li>perl (a stop-gap measure which we plan to get rid of eventually)</li>
</ul>
<p>Running wed&#8217;s tests <strong>additionally</strong> requires the following node
packages:</p>
<ul class="simple">
<li>mocha</li>
<li>chai</li>
<li>semver-sync</li>
<li>express</li>
</ul>
<p>Please see the <a class="reference external" href="package.json">package.json</a>, <a class="reference external" href="config/requirejs-config-dev.js">config/requirejs-config-dev.js</a>
and <a class="reference external" href="Makefile">Makefile</a> files for details regarding these
dependencies. Running the test suite also requires that <a class="reference external" href="http://saxon.sourceforge.net/">saxon</a> be installed.</p>
<p>Running wed&#8217;s selenium-based tests <strong>additionally</strong> requires the
following:</p>
<ul class="simple">
<li>Python 2.7.</li>
<li>Python&#8217;s Selenium package.</li>
<li><a class="reference external" href="http://gihub.com/mangalam-research/selenic">selenic</a></li>
<li>behave (the python package)</li>
<li>nginx is highly recommended.</li>
</ul>
<p>If you want to contribute to salve, your code will have to pass the
checks listed in <a class="reference external" href=".glerbl/repo_conf.py">.glerbl/repo_conf.py</a>. So you either have to
install glerbl to get those checks done for you or run the checks
through other means. See <a class="reference internal" href="#contributing">Contributing</a>.</p>
</div>
<div class="section" id="building">
<h1>Building<a class="headerlink" href="#building" title="Permalink to this headline">¶</a></h1>
<p>Everything generated during a build is output to the <a class="reference external" href="build">build</a>
subdirectory, except for some documentation files like
<a class="reference external" href="README.html">README.html</a> and <a class="reference external" href="CHANGELOG.html">CHANGELOG.html</a> which are in the root
directory.</p>
<p>For now, wed uses a Makefile to build itself. You might want to create
a <tt class="docutils literal"><span class="pre">local.mk</span></tt> file to record settings specific to your own build
environment. See the start of the <a class="reference external" href="Makefile">Makefile</a> to see what variables
you can set. When everything is set, run:</p>
<div class="highlight-python"><pre>$ make</pre>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If you get a failure please try issuing <tt class="docutils literal"><span class="pre">make</span></tt> a second
time. There are some (rare) usage scenarios in which make
can get confused about its dependencies. A second run
clears it up.</p>
</div>
<p>This Makefile will download external packages (like jquery and
Bootstrap) and place them in <a class="reference external" href="downloads">downloads</a>. It will then create a
tree of files that could be served by a web server. The files will be
in <a class="reference external" href="build/standalone">build/standalone</a>. As the name &#8220;standalone&#8221; implies, this build
includes <strong>everything</strong> needed to run wed on your own server, except
the configuration for RequireJS.</p>
<p>Make will additionally create an optimized version of wed in
<a class="reference external" href="build/standalone-optimized">build/standalone-optimized</a>. This is a version that has been
optimized using RequireJS&#8217; <tt class="docutils literal"><span class="pre">r.js</span></tt> optimizer. This optimization
exists for illustration purposes and for testing wed. See the
&#8220;Deployment Considerations&#8221; section in the <a class="reference external" href="tech_notes.rst">tech_notes.rst</a> file to
determine whether this is the optimization you want to use to deploy
wed.</p>
</div>
<div class="section" id="testing">
<h1>Testing<a class="headerlink" href="#testing" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference external" href="tech_notes.rst">tech_notes.rst</a>.</p>
</div>
<div class="section" id="local-demo">
<h1>Local Demo<a class="headerlink" href="#local-demo" title="Permalink to this headline">¶</a></h1>
<p>To see the local demo, you must have a minimal server running just
like the one needed to run the browser-dependent test suite (see the
&#8220;In-Browser Tests&#8221; section in <a class="reference external" href="tech_notes.rst">tech_notes.rst</a>) and then point your
browser to either:</p>
<ul class="simple">
<li><a class="reference external" href="http://localhost:8888/build/standalone/kitchen-sink.html">http://localhost:8888/build/standalone/kitchen-sink.html</a> to
view the demo with the unoptimized file tree.</li>
<li>or
<a class="reference external" href="http://localhost:8888/build/standalone-optimized/kitchen-sink.html">http://localhost:8888/build/standalone-optimized/kitchen-sink.html</a>
to view the demo with an optimized file tree.</li>
</ul>
<p>The demo currently starts with an empty document using a vanilla TEI
schema. Things you can do:</p>
<ul class="simple">
<li>Hit F1 to get help. This help also displays the information
regarding how and when the wed instance you are using was built.</li>
<li>Use the left mouse button to bring up a context menu. Such a menu
exists for starting tags and all positions that are editable. This
menu allows inserting elements. Ctrl-/ also brings up this menu.</li>
<li>Insert text where text is valid.</li>
<li>Ctrl-Z to undo.</li>
<li>Ctrl-Y to redo.</li>
<li>Ctrl-C to copy.</li>
<li>Ctrl-V to paste.</li>
<li>Ctrl-X to cut.</li>
<li>Ctrl-S to save. The data is currently dumped into a file located at
<a class="reference external" href="build/ajax/save.txt">build/ajax/save.txt</a>, and you won&#8217;t be able to reload it. For full
functionality wed needs to be used with a server able to save the
data and serve it intelligently.</li>
<li>Ctrl-` to go into development mode. This will bring up a log window
and allow the use of F2 to dump the element to the console.</li>
</ul>
<p>It is possible to run the kitchen sink with a different mode than the
default one (generic) by passing a <tt class="docutils literal"><span class="pre">mode</span></tt> parameter in the URL, for
instance the URL
<a class="reference external" href="http://localhost:8888/web/kitchen-sink.html?mode=tei">http://localhost:8888/web/kitchen-sink.html?mode=tei</a> would tell
the kitchen sink to load the tei mode.</p>
</div>
<div class="section" id="using">
<h1>Using<a class="headerlink" href="#using" title="Permalink to this headline">¶</a></h1>
<p>Wed expects the XML files it uses to have been converted from XML to
an ad-hoc HTML version. So the data passed to it must have been
converted by <a class="reference external" href="lib/wed/xml-to-html.xsl">lib/wed/xml-to-html.xsl</a>. Various schemas and projects
will have different needs regarding white space handling, so it is
likely you&#8217;ll want to create your own <tt class="docutils literal"><span class="pre">xml-to-html.xsl</span></tt> file that will
import <a class="reference external" href="lib/wed/xml-to-html.xsl">lib/wed/xml-to-html.xsl</a> but customize white space handling.</p>
<p>To include wed in a web page you must:</p>
<ul>
<li><p class="first">Require <a class="reference external" href="lib/wed/wed.js">lib/wed/wed.js</a></p>
</li>
<li><p class="first">Instantiate an <tt class="docutils literal"><span class="pre">Editor</span></tt> object of that module as follows:</p>
<div class="highlight-python"><pre>var editor = new wed.Editor();
[...]
editor.init(widget, options);</pre>
</div>
<p>Between the creation of the <tt class="docutils literal"><span class="pre">Editor</span></tt> object and the call to
<tt class="docutils literal"><span class="pre">init</span></tt>, there conceivably could be some calls to add event
handlers or condition handlers. The <tt class="docutils literal"><span class="pre">widget</span></tt> parameter must be an
element (preferably a <tt class="docutils literal"><span class="pre">div</span></tt>) which contains the entire data
structure to edit (converted by <tt class="docutils literal"><span class="pre">xml-to-html.xsl</span></tt> or a
customization of it). The <tt class="docutils literal"><span class="pre">options</span></tt> parameter is a dictionary
which at present understands the following keys:</p>
<ul>
<li><p class="first"><tt class="docutils literal"><span class="pre">schema</span></tt>: the path to the schema to use for interpreting the
document. This file must contain the result of doing the schema
conversion required by salve since wed uses salve. See
salve&#8217;s documentation.</p>
</li>
<li><p class="first"><tt class="docutils literal"><span class="pre">mode</span></tt>: a simple object recording mode parameters. This object
must have a <tt class="docutils literal"><span class="pre">path</span></tt> field set to the RequireJS path of the
mode. An optional <tt class="docutils literal"><span class="pre">options</span></tt> field may contain options to be
passed to the mode. Wed comes bundled with a generic mode located
at <a class="reference external" href="lib/wed/modes/generic/generic.js">lib/wed/modes/generic/generic.js</a>.</p>
<p>The <tt class="docutils literal"><span class="pre">path</span></tt> field may be abbreviated. For instance if wed is
given the path <tt class="docutils literal"><span class="pre">&quot;foo&quot;</span></tt>, it will try to load the module
<tt class="docutils literal"><span class="pre">foo</span></tt>. If this fails, it will try to load <tt class="docutils literal"><span class="pre">modes/foo/foo</span></tt>.  If
this fails, it will try to load <tt class="docutils literal"><span class="pre">modes/foo/foo_mode</span></tt>. These
paths are all relative to the wed directory.</p>
</li>
</ul>
<p>If <tt class="docutils literal"><span class="pre">options</span></tt> is absent, wed will attempt getting its configuration
from RequireJS by calling <tt class="docutils literal"><span class="pre">module.config()</span></tt>. See the RequireJS
documentation. The <tt class="docutils literal"><span class="pre">wed/wed</span></tt> configuration in
<a class="reference external" href="config/requirejs-config-dev.js">config/requirejs-config-dev.js</a> gives an example of how this can
be used.</p>
</li>
</ul>
<p>Here is an example of an <tt class="docutils literal"><span class="pre">options</span></tt> object:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="p">{</span>
     <span class="n">schema</span><span class="p">:</span> <span class="s">&#39;test/tei-simplified-rng.js&#39;</span><span class="p">,</span>
     <span class="n">mode</span><span class="p">:</span> <span class="p">{</span>
         <span class="n">path</span><span class="p">:</span> <span class="s">&#39;wed/modes/generic/generic&#39;</span><span class="p">,</span>
         <span class="n">options</span><span class="p">:</span> <span class="p">{</span>
             <span class="n">meta</span><span class="p">:</span> <span class="s">&#39;test/tei-meta&#39;</span>
         <span class="p">}</span>
     <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The <tt class="docutils literal"><span class="pre">mode.options</span></tt> will be passed to the generic mode when it is
created. What options are accepted and what they mean is determined by
each mode.</p>
<p>The <a class="reference external" href="lib/wed/onerror.js">lib/wed/onerror.js</a> module installs a global onerror
handler. By default it calls whatever onerror handler already existed
at the time of installation. Sometimes this is not the desired
behavior (for instance when testing with <tt class="docutils literal"><span class="pre">mocha</span></tt>). In such cases the
<tt class="docutils literal"><span class="pre">suppress_old_onerror</span></tt> option set to a true value will prevent the
module from calling the old onerror.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Wed installs its own handler so that if any error occurs
it knows about it, attempts to save the data and forces
the user to reload. The unfortunate upshot of this is
that any other JavaScript executing on a page where wed
is running could trip wed&#8217;s onerror handler and cause wed
to think it crashed. For this reason you must not run
wed with JavaScript code that causes onerror to fire.</p>
</div>
</div>
<div class="section" id="round-tripping">
<h1>Round-Tripping<a class="headerlink" href="#round-tripping" title="Permalink to this headline">¶</a></h1>
<p>The transformations performed by <a class="reference external" href="lib/wed/xml-to-html.xsl">lib/wed/xml-to-html.xsl</a> and
<a class="reference external" href="lib/wed/html-to-xml.xsl">lib/wed/html-to-xml.xsl</a> are not byte-for-byte reverse
operations. Suppose document A is converted from xml to html, remains
unmodified, and is converted back and saved as B, B will <strong>mean</strong> the
same thing as A but will not necessarily be <strong>identical</strong> to A. Here are
the salient points:</p>
<ul class="simple">
<li>Comments, CDATA, and processing instructions are lost.</li>
<li>The order of attributes could change.</li>
<li>The order and location of namespaces could change.</li>
<li>The encoding of empty elements could change. That is, <tt class="docutils literal"><span class="pre">&lt;foo/&gt;</span></tt> could
become <tt class="docutils literal"><span class="pre">&lt;foo&gt;&lt;/foo&gt;</span></tt> or vice-versa.</li>
<li>The presence or absence of a newline on the last line may not be
preserved.</li>
</ul>
</div>
<div class="section" id="contributing">
<h1>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h1>
<p>Contributions must pass the commit checks turned on in
<a class="reference external" href=".glerbl/repo_conf.py">.glerbl/repo_conf.py</a>. Use <tt class="docutils literal"><span class="pre">glerbl</span> <span class="pre">install</span></tt> to install the
hooks. Glerbl itself can be found at
<a class="reference external" href="https://github.com/lddubeau/glerbl">https://github.com/lddubeau/glerbl</a>. It will eventually make its way to
the Python package repository so that <tt class="docutils literal"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">glerbl</span></tt> will
work.</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Introduction</a></li>
<li><a class="reference internal" href="#browser-requirements">Browser Requirements</a></li>
<li><a class="reference internal" href="#dependencies">Dependencies</a></li>
<li><a class="reference internal" href="#building">Building</a></li>
<li><a class="reference internal" href="#testing">Testing</a></li>
<li><a class="reference internal" href="#local-demo">Local Demo</a></li>
<li><a class="reference internal" href="#using">Using</a></li>
<li><a class="reference internal" href="#round-tripping">Round-Tripping</a></li>
<li><a class="reference internal" href="#contributing">Contributing</a></li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/usage.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="index.html">Wed 0.10.0 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Louis-Dominique Dubeau.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>