{"version":3,"file":"transformation-test.js","sourceRoot":"","sources":["../../../../../lib/tests/wed/transformation-test.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * @author Louis-Dominique Dubeau\n * @license MPL 2.0\n * @copyright Mangalam Research Center for Buddhist Languages\n */\nimport { Editor } from \"wed/editor\";\nimport * as transformation from \"wed/transformation\";\n\nimport * as globalConfig from \"../base-config\";\n\nimport { EditorSetup } from \"../wed-test-util\";\n\nconst assert = chai.assert;\n\ndescribe(\"transformation\", () => {\n  let setup: EditorSetup;\n  let editor: Editor;\n\n  before(() => {\n    setup = new EditorSetup(\n      \"/base/build/standalone/lib/tests/wed_test_data/source_converted.xml\",\n      globalConfig.config,\n      document);\n    ({ editor } = setup);\n    return setup.init();\n  });\n\n  afterEach(() => {\n    setup.reset();\n  });\n\n  after(() => {\n    setup.restore();\n    // tslint:disable-next-line:no-any\n    (editor as any) = undefined;\n  });\n\n  describe(\"swapWithPreviousHomogeneousSibling\", () => {\n    it(\"swaps\", () => {\n      const ps = editor.dataRoot.querySelectorAll(\"body>p\");\n      transformation.swapWithPreviousHomogeneousSibling(editor, ps[1]);\n\n      const ps2 = editor.dataRoot.querySelectorAll(\"body>p\");\n      assert.equal(ps[0], ps2[1]);\n      assert.equal(ps2[1], ps[0]);\n    });\n\n    it(\"does nothing if the element is the first child\", () => {\n      const ps = editor.dataRoot.querySelectorAll(\"publicationStmt>p\");\n      transformation.swapWithPreviousHomogeneousSibling(editor, ps[0]);\n\n      const ps2 = editor.dataRoot.querySelectorAll(\"publicationStmt>p\");\n      assert.equal(ps[0], ps2[0]);\n    });\n\n    it(\"does nothing if the previous element is not homogeneous\", () => {\n      const divs = editor.dataRoot.querySelectorAll(\"body>div\");\n      transformation.swapWithPreviousHomogeneousSibling(editor, divs[0]);\n\n      const divs2 = editor.dataRoot.querySelectorAll(\"body>div\");\n      assert.equal(divs[0].previousSibling, divs2[0].previousSibling);\n    });\n  });\n\n  describe(\"swapWithNextHomogeneousSibling\", () => {\n    it(\"swaps\", () => {\n      const ps = editor.dataRoot.querySelectorAll(\"body>p\");\n      transformation.swapWithNextHomogeneousSibling(editor, ps[0]);\n\n      const ps2 = editor.dataRoot.querySelectorAll(\"body>p\");\n      assert.equal(ps[0], ps2[1]);\n      assert.equal(ps2[1], ps[0]);\n    });\n\n    it(\"does nothing if the element is the last child\", () => {\n      const ps = editor.dataRoot.querySelectorAll(\"publicationStmt>p\");\n      transformation.swapWithNextHomogeneousSibling(editor, ps[ps.length - 1]);\n\n      const ps2 = editor.dataRoot.querySelectorAll(\"publicationStmt>p\");\n      assert.equal(ps[ps.length - 1], ps2[ps.length - 1]);\n    });\n\n    it(\"does nothing if the next element is not homogeneous\", () => {\n      const divs = editor.dataRoot.querySelectorAll(\"body>div\");\n      transformation.swapWithNextHomogeneousSibling(editor, divs[0]);\n\n      const divs2 = editor.dataRoot.querySelectorAll(\"body>div\");\n      assert.equal(divs[0].previousSibling, divs2[0].previousSibling);\n    });\n  });\n});\n\n//  LocalWords:  rng wedframe RequireJS dropdown Ctrl Mangalam MPL\n//  LocalWords:  Dubeau previousSibling nextSibling abcd jQuery xmlns\n//  LocalWords:  sourceDesc publicationStmt titleStmt fileDesc txt\n//  LocalWords:  ajax xml moveCaretRight moveCaretLeft teiHeader html\n//  LocalWords:  innerHTML nodeValue seekCaret nodeToPath pathToNode\n//  LocalWords:  mouseup mousedown unhandled requirejs btn gui metas\n//  LocalWords:  wedroot tei domutil onerror jquery chai\n"]}