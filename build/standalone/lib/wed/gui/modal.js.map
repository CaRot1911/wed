{"version":3,"sources":["../../../wed/gui/modal.ts"],"names":[],"mappings":"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","file":"modal.js","sourcesContent":["/**\n * Modal dialog boxes.\n * @author Louis-Dominique Dubeau\n * @license MPL 2.0\n * @copyright Mangalam Research Center for Buddhist Languages\n */\nimport \"bootstrap\";\nimport * as interact from \"interact\";\nimport * as $ from \"jquery\";\nimport * as browsers from \"../browsers\";\n\n/**\n * This records changes in such a way that if any of the changes cannot take\n * effect, then all the changes are \"rolled back\". It is called pseudo-atomic\n * because it is not really meant to track any changes that do not happen\n * through instances of this class. This is needed because we are changing the\n * size of multiple elements, and beyond a certain \"smallness\", some elements\n * won't register any change in dimensions (perhaps due to \"min-...\" styles.\n */\nclass PseudoAtomicRectChange {\n  private readonly changes: { el: HTMLElement, rect: ClientRect }[] = [];\n  private rolledback: boolean = false;\n\n  updateElementRect(el: HTMLElement, dx: number, dy: number): void {\n    // If we've already rolled back, we don't do anything.\n    if (this.rolledback) {\n      return;\n    }\n\n    let rect = el.getBoundingClientRect();\n\n    // This works around a fractional pixel issue in IE. We set the element to\n    // the dimensions returned by getBoundingClientRect and then reacquire the\n    // dimensions to account for any funny adjustments IE may decide to do.\n    if (browsers.MSIE) {\n      el.style.width = `${rect.width}px`;\n      el.style.height = `${rect.height}px`;\n\n      rect = el.getBoundingClientRect();\n    }\n\n    const width = rect.width + dx;\n    const height = rect.height + dy;\n    el.style.width = `${width}px`;\n    el.style.height = `${height}px`;\n    this.changes.push({ el: el, rect: rect });\n    const newRect = el.getBoundingClientRect();\n\n    // Check whether the change \"took\". If not, roll back.\n    if (newRect.width !== width || newRect.height !== height) {\n      this.rollback();\n    }\n  }\n\n  rollback(): void {\n    const changes = this.changes;\n    for (const change of changes) {\n      const el = change.el;\n      const rect = change.rect;\n      el.style.width = `${rect.width}px`;\n      el.style.height = `${rect.height}px`;\n    }\n\n    this.rolledback = true;\n  }\n}\n\nexport interface Options {\n  /**\n   * Whether this modal can be resized.\n   */\n  resizable?: boolean;\n\n  /**\n   * Whether this modal can be dragged .\n   */\n  draggable?: boolean;\n}\n\n/**\n * A modal needs to be created only once per instance of wed. After creation it\n * must be installed into the DOM tree of the page on which it is going to be\n * used. The method [[Modal.getTopLevel]] must be used to get the top level DOM\n * element of the modal which will be inserted into the page. Once inserted, the\n * modal is ready to be used once, twice, or more times. It need not be removed,\n * re-created, etc. The method [[Modal.modal]] just needs to be called each time\n * the modal must be displayed.\n *\n * A typical usage scenario would be:\n *\n * <pre>\n *   // Modal setup.\n *   mymodal = new Modal();\n *   mymodal.setTitle(\"My modal\");\n *   mymodal.setBody(...);\n *   mymodal.addYesNo();\n *   // This is a generic example of how to add the modal to a page.\n *   $(\"body\").append(mymodal.getTopLevel());\n *\n *   ...\n *\n *   // Modal use\n *   mymodal.modal(function () {...});\n *   switch(mymodal.getClickedAsText()) {...}\n *\n *   ...\n *\n *   // A second use of the same modal\n *   mymodal.modal(function () {...});\n *   switch(mymodal.getClickedAsText()) {...}\n * </pre>\n *\n * If the same modal must be displayed on two different pages, then two Modal\n * objects should be created, one per page.\n */\nexport class Modal {\n  private readonly _$dom: JQuery;\n  private readonly _$header: JQuery;\n  private readonly _$body: JQuery;\n  private readonly _$footer: JQuery;\n  private _$clicked: JQuery | undefined;\n\n  constructor(options?: Options) {\n    options = options != null ? options : {};\n\n    // tabindex needed to make keyboard stuff work... grumble...\n    // https://github.com/twitter/bootstrap/issues/4663\n    // tslint:disable-next-line:no-jquery-raw-elements\n    this._$dom = $(\"\\\n<div class=\\\"modal\\\" style=\\\"position: absolute\\\" tabindex=\\\"1\\\">\\\n  <div class=\\\"modal-dialog\\\">\\\n    <div class=\\\"modal-content\\\">\\\n      <div class=\\\"modal-header\\\">\\\n        <button type=\\\"button\\\" class=\\\"close\\\" data-dismiss=\\\"modal\\\" \\\n         aria-hidden=\\\"true\\\">&times;</button>\\\n        <h3 class=\\\"modal-title\\\">Untitled</h3>\\\n      </div>\\\n      <div class=\\\"modal-body\\\">\\\n        <p>No body.</p>\\\n      </div>\\\n      <div class=\\\"modal-footer\\\">\\\n      </div>\\\n    </div>\\\n  </div>\\\n</div>\");\n    this._$header = this._$dom.find(\".modal-header\");\n    this._$body = this._$dom.find(\".modal-body\");\n    this._$footer = this._$dom.find(\".modal-footer\");\n    this._$dom.on(\"click\", \".btn\", (ev) => {\n      this._$clicked = $(ev.currentTarget);\n      return true;\n    });\n\n    this._$dom.on(\"shown.bs.modal.modal\",\n                  this._handleShown.bind(this));\n\n    const content = this._$dom.find(\".modal-content\")[0];\n    const body = this._$body[0];\n    const win = body.ownerDocument.defaultView;\n\n    const $dom = this._$dom;\n    if (options.resizable as boolean) {\n      body.style.overflow = \"auto\";\n      // We listen to resizestart and resizeend to deal with the following\n      // scenario: the user starts resizing the modal, it goes beyond the limits\n      // of how big it can be resized, the mouse pointer moves outside the modal\n      // window and the user releases the button when the pointer is\n      // outside. Without the use of ignoreBackdropClick, this causes the modal\n      // to close.\n      interact(content)\n        .resizable({})\n        .on(\"resizestart\", () => {\n          const modal = $dom.data(\"bs.modal\");\n          if (modal == null) {\n            return; // Deal with edge cases.\n          }\n          // Prevent modal closure.\n          modal.ignoreBackdropClick = true;\n        })\n        .on(\"resizeend\", () => {\n          // We use a setTimeout otherwise we turn ignoreBackdropClick too soon.\n          setTimeout(() => {\n            const modal = $dom.data(\"bs.modal\");\n            if (modal == null) {\n              return; // Deal with edge cases.\n            }\n            modal.ignoreBackdropClick = false;\n          },\n                     0);\n        })\n        .on(\"resizemove\", (event: Interact.InteractEvent) => {\n          const target = event.target;\n\n          const change = new PseudoAtomicRectChange();\n          change.updateElementRect(target, event.dx, event.dy);\n          change.updateElementRect(body, event.dx, event.dy);\n        });\n    }\n\n    if (options.draggable as boolean) {\n      interact(this._$header[0])\n        .draggable({\n                     restrict: {\n                       restriction: {\n                         left: 0,\n                         top: 0,\n                         right: win.innerWidth - 10,\n                         bottom: win.innerHeight - 10,\n                       },\n                     },\n                   })\n        .on(\"dragmove\", (event: Interact.InteractEvent) => {\n          const target = content;\n\n          target.style.left = `${event.clientX - event.clientX0}px`;\n          target.style.top = `${event.clientY - event.clientY0}px`;\n        });\n    }\n  }\n\n  /**\n   * @returns The top level node of the modal, to be inserted\n   * into a page.\n   */\n  getTopLevel(): JQuery {\n    return this._$dom;\n  }\n\n  /**\n   * Set the title of this modal.\n   */\n  setTitle(title: string | JQuery | Element | Text): void {\n    const $h3 = this._$header.find(\"h3\");\n    $h3.empty();\n    $h3.append(title);\n  }\n\n  /**\n   * Set the body of this modal.\n   */\n  setBody(body: string | JQuery | Element| Text): void {\n    this._$body.empty();\n    this._$body.append(body);\n  }\n\n  /**\n   * Set the footer of this modal.\n   */\n  setFooter(footer: string | JQuery | Element | Text): void {\n    this._$footer.empty();\n    this._$footer.append(footer);\n  }\n\n  /**\n   * @param name The name of the button.\n   *\n   * @param isPrimary True if the button is primary. A modal takes only one\n   * primary button but no check is made by this method to prevent it. The\n   * primary button is the one clicked if the user hits enter.\n   *\n   * @returns The jQuery object for the button.\n   */\n  addButton(name: string, isPrimary: boolean = false): JQuery {\n    const button = this._$dom[0].ownerDocument.createElement(\"a\");\n    button.href = \"#\";\n    button.className = \"btn\";\n    button.setAttribute(\"data-dismiss\", \"modal\");\n    button.textContent = name;\n    button.classList.add(isPrimary ? \"btn-primary\" : \"btn-default\");\n    this._$footer.append(button);\n    return $(button);\n  }\n\n  /**\n   * Adds one Ok and one Cancel button.\n   *\n   * @returns The two buttons added.\n   */\n  addOkCancel(): JQuery[] {\n    return [this.addButton(\"Ok\", true), this.addButton(\"Cancel\")];\n  }\n\n  /**\n   * Adds one Yes and one No button.\n   *\n   * @returns The two buttons added.\n   */\n  addYesNo(): JQuery[] {\n    return [this.addButton(\"Yes\", true), this.addButton(\"No\")];\n  }\n\n  /**\n   * Returns the primary button.\n   *\n   * @returns The primary button.\n   */\n  getPrimary(): JQuery {\n    return this._$footer.find(\".btn-primary\");\n  }\n\n  /**\n   * @param callback A callback to call when the modal is dismissed by the\n   * user. This modal would typically inspect the modal to determine what the\n   * user did, and potentially clean up after itself. The callback is left out\n   * if the modal is merely for informational purposes.\n   */\n  modal(callback?: () => void): void {\n    this._$clicked = undefined;\n    if (callback !== undefined) {\n      this._$dom.one(\"hidden.bs.modal.modal\", callback);\n    }\n    this._$dom.modal();\n  }\n\n  /**\n   * @returns The button that was clicked. Could be undefined if the modal\n   * disappeared without being normally dismissed or if the modal has not been\n   * used yet.\n   */\n  getClicked(): JQuery | undefined {\n    return this._$clicked;\n  }\n\n  /**\n   * @returns The text of the button that was clicked. Could be undefined if the\n   * modal disappeared without being normally dismissed or if the modal has not\n   * been used yet.\n   */\n  getClickedAsText(): string | undefined {\n    if (this._$clicked === undefined) {\n      return undefined;\n    }\n\n    return this._$clicked.text();\n  }\n\n  /**\n   * Handles the ``shown`` event.\n   *\n   * @param {Event} ev The DOM event.\n   */\n  private _handleShown(): void {\n    const win = this._$dom[0].ownerDocument.defaultView;\n    const winHeight = win.innerHeight;\n    const dialog = this._$dom.find(\".modal-dialog\")[0];\n    const rect = dialog.getBoundingClientRect();\n    const computedStyle = window.getComputedStyle(dialog);\n    // eslint-disable-next-line no-mixed-operators\n    const diff = -rect.top + (winHeight - rect.height) -\n      parseInt(computedStyle.marginBottom!);\n    const dialogMaxHeight = rect.height + diff;\n    dialog.style.maxHeight = `${dialogMaxHeight}px`;\n    const content = this._$dom.find(\".modal-content\")[0];\n    content.style.maxHeight = `${dialogMaxHeight}px`;\n  }\n}\n\n//  LocalWords:  Ok DOM gui Mangalam MPL Dubeau getClickedAsText pre\n//  LocalWords:  addYesNo setBody setTitle mymodal jquery html href\n//  LocalWords:  bs jQuery param btn tabindex util getTopLevel\n"]}