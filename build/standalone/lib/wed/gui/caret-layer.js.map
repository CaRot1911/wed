{"version":3,"sources":["../../../wed/gui/caret-layer.ts"],"names":[],"mappings":";;;;;;;;;;;;;IASA;;OAEG;IACH;QAAgC,8BAAK;QAEnC,oBAAY,OAAqB,EAAE,EAAe;YAAlD,YACE,kBAAM,OAAO,EAAE,EAAE,CAAC,SAInB;YAHC,KAAI,CAAC,GAAG,GAAG,CAAC,CAAC,EAAE,CAAC,CAAC;YACjB,KAAI,CAAC,GAAG,CAAC,EAAE,CAAC,6BAA6B,EAC7B,KAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAI,CAAC,CAAC,CAAC;;QACtD,CAAC;QAEO,2CAAsB,GAA9B,UAA+B,CAAyB;YACtD,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,WAAW,CAAC,CAAC,CAAC;gBAC3B,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,WAAW,EAAE,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBACjE,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,SAAS,EAAE,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAClE,CAAC;YAED,IAAM,SAAS,GAAG,IAAI,CAAC,OAAO,CAAC,yBAAyB,CAAC,CAAC,CAAC,OAAO,EACT,CAAC,CAAC,OAAO,CAAC,CAAC;YACpE,EAAE,CAAC,CAAC,SAAS,KAAK,SAAS,CAAC,CAAC,CAAC;gBAC5B,IAAM,IAAI,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;gBAChC,IAAI,CAAC,MAAM,GAAG,SAAS,CAAC;gBACxB,kCAAkC;gBACjC,IAAY,CAAC,SAAS,GAAG,SAAS,CAAC;gBACpC,CAAC,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBAC3B,EAAE,CAAC,CAAC,CAAC,CAAC,IAAI,KAAK,SAAS,CAAC,CAAC,CAAC;oBACzB,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC;gBAC5B,CAAC;YACH,CAAC;YACD,CAAC,CAAC,cAAc,EAAE,CAAC;YACnB,CAAC,CAAC,eAAe,EAAE,CAAC;QACtB,CAAC;QACH,iBAAC;IAAD,CA9BA,AA8BC,CA9B+B,aAAK,GA8BpC;IA9BY,gCAAU","file":"caret-layer.js","sourcesContent":["/**\n * A layer that manages carets.\n * @author Louis-Dominique Dubeau\n * @license MPL 2.0\n * @copyright Mangalam Research Center for Buddhist Languages\n */\nimport { Layer } from \"./layer\";\nimport { LayerManager } from \"./layer-manager\";\n\n/**\n * A layer that manages carets.\n */\nexport class CaretLayer extends Layer {\n  private readonly $el: JQuery;\n  constructor(manager: LayerManager, el: HTMLElement) {\n    super(manager, el);\n    this.$el = $(el);\n    this.$el.on(\"mousedown click contextmenu\",\n                this.caretLayerMouseHandler.bind(this));\n  }\n\n  private caretLayerMouseHandler(e: JQueryMouseEventObject): void {\n    if (e.type === \"mousedown\") {\n      this.$el.on(\"mousemove\", this.caretLayerMouseHandler.bind(this));\n      this.$el.one(\"mouseup\", this.caretLayerMouseHandler.bind(this));\n    }\n\n    const elAtMouse = this.manager.elementAtPointUnderLayers(e.clientX,\n                                                             e.clientY);\n    if (elAtMouse !== undefined) {\n      const newE = $.Event(e.type, e);\n      newE.target = elAtMouse;\n      // tslint:disable-next-line:no-any\n      (newE as any).toElement = elAtMouse;\n      $(elAtMouse).trigger(newE);\n      if (e.type === \"mouseup\") {\n        this.$el.off(\"mousemove\");\n      }\n    }\n    e.preventDefault();\n    e.stopPropagation();\n  }\n}\n"]}