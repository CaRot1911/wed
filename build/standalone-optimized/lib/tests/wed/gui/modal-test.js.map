{"version":3,"sources":["../../../tests/wed/gui/modal-test.ts"],"names":[],"mappings":"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","file":"modal-test.js","sourcesContent":["/**\n * @author Louis-Dominique Dubeau\n * @license MPL 2.0\n * @copyright Mangalam Research Center for Buddhist Languages\n */\nimport * as $ from \"jquery\";\n\nimport { Modal } from \"wed/gui/modal\";\nimport { makeWedRoot } from \"../../wed-test-util\";\n\nconst assert = chai.assert;\n\ndescribe(\"Modal\", () => {\n  let wedroot: HTMLElement;\n  let modal: Modal;\n\n  function clearWedRoot(): void {\n    // tslint:disable-next-line:no-inner-html\n    wedroot.innerHTML = \"\";\n  }\n\n  before(() => {\n    wedroot = makeWedRoot(document);\n    document.body.appendChild(wedroot);\n  });\n\n  after(() => {\n    document.body.removeChild(wedroot);\n  });\n\n  beforeEach(() => {\n    modal = new Modal();\n  });\n\n  describe(\"setTitle\", () => {\n    it(\"sets the title\", () => {\n      let $title = modal.getTopLevel().find(\".modal-header>h3\");\n      assert.equal($title.text(), \"Untitled\", \"initial title\");\n      modal.setTitle($(\"<b>foo</b>\"));\n      $title = modal.getTopLevel().find(\".modal-header>h3\");\n      assert.equal($title[0].innerHTML, \"<b>foo</b>\", \"new title\");\n    });\n  });\n\n  describe(\"setBody\", () => {\n    it(\"sets the body\", () => {\n      const body = modal.getTopLevel().find(\".modal-body\")[0];\n      assert.equal(body.innerHTML.trim(), \"<p>No body.</p>\", \"initial body\");\n      modal.setBody($(\"<p>A body.</p>\"));\n      assert.equal(body.innerHTML, \"<p>A body.</p>\", \"new body\");\n    });\n  });\n\n  describe(\"setFooter\", () => {\n    it(\"sets the footer\", () => {\n      const footer = modal.getTopLevel().find(\".modal-footer\")[0];\n      assert.equal(footer.innerHTML.trim(), \"\", \"initial footer\");\n      modal.setFooter($(\"<p>A footer.</p>\"));\n      assert.equal(footer.innerHTML, \"<p>A footer.</p>\", \"new footer\");\n    });\n  });\n\n  describe(\"addButton\", () => {\n    it(\"adds a button\", () => {\n      const footer = modal.getTopLevel().find(\".modal-footer\")[0];\n      assert.equal(footer.innerHTML.trim(), \"\", \"initial footer\");\n      const $button = modal.addButton(\"test\");\n      assert.isTrue($button.closest(footer).length > 0,\n                    \"button is present in footer\");\n      assert.equal($button.text(), \"test\");\n      assert.isFalse($button.hasClass(\"btn-primary\"));\n    });\n\n    it(\"adds a primary button\", () => {\n      const footer = modal.getTopLevel().find(\".modal-footer\")[0];\n      assert.equal(footer.innerHTML.trim(), \"\", \"initial footer\");\n      const $button = modal.addButton(\"test\", true);\n      assert.isTrue($button.closest(footer).length > 0,\n                    \"button is present in footer\");\n      assert.equal($button.text(), \"test\");\n      assert.isTrue($button.hasClass(\"btn-primary\"));\n    });\n  });\n\n  describe(\"getPrimary\", () => {\n    it(\"returns an empty set if there is no primary\", () => {\n      assert.equal(modal.getPrimary()[0], undefined);\n    });\n\n    it(\"returns the primary\", () => {\n      const $button = modal.addButton(\"test\", true);\n      assert.equal(modal.getPrimary()[0], $button[0]);\n    });\n  });\n\n  function makeAddXYTest(first: string, second: string): void {\n    describe(`add${first}${second}`, () => {\n      it(`adds ${first} and ${second} button, ${first} is primary`, () => {\n        const footer = modal.getTopLevel().find(\".modal-footer\")[0];\n        assert.equal(footer.innerHTML.trim(), \"\", \"initial footer\");\n        // tslint:disable-next-line:no-any\n        const buttons = (modal as any)[`add${first}${second}`].call(modal);\n        assert.isTrue(buttons[0].closest(footer).length > 0,\n                      \"button 0 is present in footer\");\n        assert.isTrue(buttons[1].closest(footer).length > 0,\n                      \"button 1 is present in footer\");\n\n        assert.equal(buttons[0].text(), first, \"button 0 name\");\n        assert.equal(buttons[1].text(), second, \"button 1 name\");\n\n        assert.isTrue(buttons[0].hasClass(\"btn-primary\"),\n                      \"button 0 is primary\");\n        assert.isFalse(buttons[1].hasClass(\"btn-primary\"),\n                       \"button 1 is not primary\");\n      });\n    });\n  }\n\n  // tslint:disable-next-line:mocha-no-side-effect-code\n  makeAddXYTest(\"Ok\", \"Cancel\");\n  // tslint:disable-next-line:mocha-no-side-effect-code\n  makeAddXYTest(\"Yes\", \"No\");\n\n  describe(\"getClicked\", () => {\n    afterEach(() => {\n      clearWedRoot();\n    });\n\n    it(\"returns undefined on a fresh modal\", () => {\n      assert.isUndefined(modal.getClicked());\n    });\n\n    it(\"returns the button clicked\", (done) => {\n      const okCancel = modal.addOkCancel();\n      const $dom = modal.getTopLevel();\n      wedroot.appendChild($dom[0]);\n      let clicked = false;\n      window.setTimeout(() => {\n        clicked = true;\n        $dom.find(\".btn-primary\").click();\n      }, 1);\n\n      modal.modal(() => {\n        assert.isTrue(clicked);\n        assert.equal(modal.getClicked()![0], okCancel[0][0]);\n        done();\n      });\n    });\n  });\n\n  describe(\"getClickedAsText\", () => {\n    afterEach(() => {\n      clearWedRoot();\n    });\n\n    it(\"returns undefined on a fresh modal\", () => {\n      assert.isUndefined(modal.getClickedAsText());\n    });\n\n    it(\"returns the name of the button clicked\", (done) => {\n      modal.addOkCancel();\n      const $dom = modal.getTopLevel();\n      wedroot.appendChild($dom[0]);\n      let clicked = false;\n      window.setTimeout(() => {\n        clicked = true;\n        $dom.find(\".btn-primary\").click();\n      }, 1);\n\n      modal.modal(() => {\n        assert.isTrue(clicked);\n        assert.equal(modal.getClickedAsText(), \"Ok\");\n        done();\n      });\n    });\n  });\n\n  describe(\"modal\", () => {\n    let $dom: JQuery;\n\n    beforeEach(() => {\n      modal.addOkCancel();\n      $dom = modal.getTopLevel();\n      wedroot.appendChild($dom[0]);\n    });\n\n    afterEach(() => {\n      clearWedRoot();\n    });\n\n    it(\"calls callback with proper values\", (done) => {\n      let clicked = false;\n      window.setTimeout(() => {\n        clicked = true;\n        $dom.find(\".btn-primary\").click();\n      }, 1);\n\n      modal.modal((ev) => {\n        assert.equal(ev.type, \"hidden\");\n        assert.equal(ev.namespace, \"bs.modal\");\n        assert.equal(ev.currentTarget, $dom[0]);\n        assert.isTrue(clicked);\n        done();\n      });\n    });\n\n    it(\"without a callback\", (done) => {\n      window.setTimeout(() => {\n        $dom.find(\".btn-primary\").click();\n        // Wait a bit before considering it done.\n        window.setTimeout(() => {\n          done();\n        }, 1);\n      }, 1);\n\n      // An earlier version did not accept modal being called without a\n      // callback. It would have crashed on the next call.\n      modal.modal();\n    });\n\n    it(\"cleans event handlers properly\", (done) => {\n      function click(): void {\n        modal.getPrimary().click();\n      }\n      window.setTimeout(click, 1);\n\n      let first = 0;\n      modal.modal(() => {\n        first++;\n      });\n\n      window.setTimeout(click, 1);\n      let second = 0;\n      modal.modal(() => {\n        second++;\n        assert.equal(first, 1, \"first handler count\");\n        assert.equal(second, 1, \"second handler count\");\n        done();\n      });\n    });\n  });\n});\n\n//  LocalWords:  gui jQuery jquery Dubeau MPL Mangalam btn getClicked\n//  LocalWords:  getClickedAsText Ok getPrimary addButton setFooter\n//  LocalWords:  setBody setTitle chai wedframe wedroot\n"]}