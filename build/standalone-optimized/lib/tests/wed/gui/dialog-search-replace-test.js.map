{"version":3,"sources":["../../../tests/wed/gui/dialog-search-replace-test.ts"],"names":[],"mappings":";;;IAgBA,IAAM,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;IAE3B,QAAQ,CAAC,uBAAuB,EAAE;QAChC,IAAI,KAAkB,CAAC;QACvB,IAAI,MAAc,CAAC;QACnB,IAAI,OAAoB,CAAC;QACzB,IAAI,QAAkB,CAAC;QACvB,IAAI,QAAmB,CAAC;QACxB,IAAI,YAA0B,CAAC;QAE/B,IAAI,EAAa,CAAC;QAClB,IAAI,UAAmB,CAAC;QACxB,IAAI,kBAAwB,CAAC;QAC7B,IAAI,eAA0B,CAAC;QAC/B,IAAI,cAAyB,CAAC;QAC9B,IAAI,gBAA2B,CAAC;QAChC,IAAI,YAAuB,CAAC;QAC5B,IAAI,aAAwB,CAAC;QAC7B,IAAI,iBAA4B,CAAC;QACjC,IAAI,kBAA6B,CAAC;QAClC,IAAI,kBAA6B,CAAC;QAClC,IAAI,QAAmB,CAAC;QACxB,IAAI,SAAoB,CAAC;QAEzB,MAAM,CAAC;YACL,KAAK,GAAG,IAAI,2BAAW,CACrB,wEAAwE,EACxE,YAAY,CAAC,MAAM,EACnB,QAAQ,CAAC,CAAC;YACZ,CAAG,qBAAM,CAAW,CAAC;YACrB,MAAM,CAAC,KAAK,CAAC,IAAI,EAAE,CAAC;QACtB,CAAC,CAAC,CAAC;QAEH,UAAU,CAAC;YACT,OAAO,GAAG,MAAM,CAAC,OAAO,CAAC;YACzB,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;YAC3B,YAAY,GAAG,MAAM,CAAC,YAAY,CAAC;YACnC,QAAQ,GAAG,MAAM,CAAC,YAAY,CAAC,YAAY,CAAC;YAE5C,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,OAAO,CAAE,CAAC;YAC/C,QAAQ,GAAG,IAAI,gBAAS,CACtB,YAAY,CAAC,oBAAoB,CAAC,KAAK,CAAC,UAAW,EAAE,CAAC,CAAC,EACvD,YAAY,CAAC,oBAAoB,CAAC,KAAK,CAAC,UAAW,EAAE,CAAC,CAAC,CAAC,CAAC;YAC3D,SAAS,GAAG,IAAI,gBAAS,CACvB,YAAY,CAAC,oBAAoB,CAAC,KAAK,CAAC,UAAW,EAAE,CAAC,CAAC,EACvD,YAAY,CAAC,oBAAoB,CAAC,KAAK,CAAC,UAAW,EAAE,CAAC,CAAC,CAAC,CAAC;YAE3D,EAAE,GAAG,KAAK,CAAC,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC,CAAC;YACrD,UAAU,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC;YACnB,kBAAkB,GAAG,YAAY,CAAC,oBAAoB,CACpD,WAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,UAAU,EAAE,CAAC,CAAC,CAAC,CAAC;YAC9C,YAAY,CAAC,QAAQ,CAAC,kBAAkB,CAAC,CAAC;YAE1C,6DAA6D;YAC7D,IAAM,UAAU,GAAG,WAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACpE,eAAe,GAAG,IAAI,gBAAS,CAC7B,YAAY,CAAC,oBAAoB,CAAC,UAAU,CAAC,EAC7C,YAAY,CAAC,oBAAoB,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACnE,MAAM,CAAC,eAAe,CAAC,gBAAgB,EAAE,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAEtE,cAAc,GAAG,IAAI,gBAAS,CAC5B,YAAY,CAAC,oBAAoB,CAAC,UAAU,CAAC,EAC7C,YAAY,CAAC,oBAAoB,CAAC,UAAU,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACnE,MAAM,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;YAEtE,IAAM,WAAW,GAAG,WAAI,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,UAAU,EAAE,CAAC,CAAC,CAAC;YACrE,gBAAgB,GAAG,IAAI,gBAAS,CAC9B,YAAY,CAAC,oBAAoB,CAAC,WAAW,CAAC,EAC9C,YAAY,CAAC,oBAAoB,CAAC,WAAW,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACpE,MAAM,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC,QAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YAEvE,0DAA0D;YAC1D,YAAY,GAAG,IAAI,gBAAS,CAC1B,YAAY,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,UAAW,CAAC,UAAW,EAAE,CAAC,CAAC,EACnE,YAAY,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAU,EAAE,CAAC,CAAC,CAAC,CAAC;YAE1D,2DAA2D;YAC3D,aAAa,GAAG,IAAI,gBAAS,CAC3B,YAAY,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,UAAW,CAAC,UAAW,EAAE,CAAC,CAAC,EACnE,YAAY,CAAC,oBAAoB,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,SAAU,EAAE,CAAC,CAAC,CAAC,CAAC;YAE1D,IAAM,IAAI,GAAG,EAAE,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,MAAM,CAAC,CAAC;YAC5C,iBAAiB,GAAG,IAAI,gBAAS,CAC/B,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,EAC1C,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;YAE9C,kBAAkB,GAAG,IAAI,gBAAS,CAChC,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,EAC1C,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;YAE9C,kBAAkB,GAAG,IAAI,gBAAS,CAChC,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,EAC1C,YAAY,CAAC,oBAAoB,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC,CAAC;QAChD,CAAC,CAAC,CAAC;QAEH,SAAS,CAAC;YACR,gDAAgD;YAChD,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,YAAY,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC;YACxD,KAAK,CAAC,KAAK,EAAE,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,KAAK,CAAC;YACJ,KAAK,CAAC,OAAO,EAAE,CAAC;YAChB,kCAAkC;YACjC,MAAc,GAAG,SAAS,CAAC;QAC9B,CAAC,CAAC,CAAC;QAEH,oBAAoB,SAAoB;YACtC,kCAAkC;YAClC,MAAM,CAAC,IAAI,2CAAmB,CAAC,MAAM,EAAG,MAAc,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;QAC9E,CAAC;QAED,8BAA8B,KAAgB;YAC5C,IAAM,UAAU,GAAG,QAAQ,CAAC,gBAAgB,CAAC,iBAAiB,CAAE,CAAC;YACjE,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAC7D,IAAI,aAAa,GAAG,UAAU,CAAC,CAAC,CAAC,CAAC,qBAAqB,EAAE,CAAC;YAC1D,IAAM,SAAS,GACb,KAAK,CAAC,gBAAgB,EAAE,CAAC,WAAW,CAAC,qBAAqB,EAAE,CAAC;YAE/D,wEAAwE;YACxE,sEAAsE;YACtE,SAAS;YAET,+CAA+C;YAC/C,MAAM,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC;iBAC9D,OAAO,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC,CAAC,CAAC;YAC7B,MAAM,CAAC,aAAa,EAAE,cAAc,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC;iBAChE,OAAO,CAAC,SAAS,CAAC,IAAI,EAAE,CAAC,CAAC,CAAC;YAE9B,aAAa,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,qBAAqB,EAAE,CAAC;YAC1E,MAAM,CAAC,aAAa,EAAE,gBAAgB,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,QAAQ,CAAC;iBACpE,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,CAAC,CAAC,CAAC;YAChC,MAAM,CAAC,aAAa,EAAE,eAAe,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;iBAClE,OAAO,CAAC,SAAS,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;QACjC,CAAC;QAED;YACI,MAAM,CAAC,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,IAAI,CAAC;QACjE,CAAC;QAED;YACE,IAAM,KAAK,GAAG,QAAQ,CAAC,aAAa,CAAC,kBAAkB,CAAgB,CAAC;YACxE,KAAK,CAAC,KAAK,EAAE,CAAC;QAChB,CAAC;QAED,sBAAsB,IAAY;YAChC,IAAM,MAAM,GAAG,QAAQ;iBACpB,aAAa,CAAC,8BAA8B,CAAqB,CAAC;YACrE,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;YACpB,CAAC,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC7B,CAAC;QAED,uBAAuB,IAAY;YACjC,IAAM,KAAK,GAAG,QAAQ;iBACnB,aAAa,CAAC,+BAA+B,CAAqB,CAAC;YACtE,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC;YACnB,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC5B,CAAC;QAED;YACE,IAAM,KAAK,GAAG,QAAQ;iBACnB,aAAa,CAAC,+BAA+B,CAAqB,CAAC;YACtE,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC;YACjB,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;QAC5B,CAAC;QAED;YACE,IAAM,IAAI,GAAG,QAAQ;iBAClB,aAAa,CAAC,kCAAkC,CAAsB,CAAC;YAC1E,IAAI,CAAC,KAAK,EAAE,CAAC;QACf,CAAC;QAED;YACE,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,yCAAyC,CAC9C,CAAC;YACtB,MAAM,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC;QAED;YACE,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,wCAAwC,CAC7C,CAAC;YACtB,MAAM,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC;QAED;YACE,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,6CAA6C,CAClD,CAAC;YACtB,MAAM,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC;QAED,4BAA4B,OAAgB;YAC1C,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,yCAAyC,CAC9C,CAAC;YACtB,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC;QAC9D,CAAC;QAED,+BAA+B,OAAgB;YAC7C,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,wCAAwC,CAC7C,CAAC;YACtB,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC;QAC9D,CAAC;QAED;YACE,IAAM,MAAM,GACT,QAAQ,CAAC,aAAa,CAAC,4CAA4C,CACjD,CAAC;YACtB,MAAM,CAAC,KAAK,EAAE,CAAC;QACjB,CAAC;QAED,QAAQ,CAAC,qBAAqB,EAAE;YAE9B,UAAU,CAAC;gBACT,gBAAgB,EAAE,CAAC;YACrB,CAAC,CAAC,CAAC;YAEH,SAAS,CAAC;gBACR,WAAW,EAAE,CAAC;YAChB,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,cAAc,EAAE;gBACjB,UAAU,CAAC,iCAAS,CAAC,OAAO,CAAC,CAAC;YAChC,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,2CAA2C,EAAE;gBAC9C,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,oBAAoB,CAAC,YAAY,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,kBAAkB,EAAE;gBACrB,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,oBAAoB,CAAC,YAAY,CAAC,CAAC;gBACnC,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,eAAe,CAAC,CAAC;YACxC,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,oBAAoB,EAAE;gBACvB,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,oBAAoB,CAAC,YAAY,CAAC,CAAC;gBACnC,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,eAAe,CAAC,CAAC;gBACtC,cAAc,EAAE,CAAC;gBACjB,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,YAAY,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,8CAA8C,EAAE;gBACjD,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,aAAa,CAAC,CAAC;gBAC5B,gBAAgB,EAAE,CAAC;YACrB,CAAC,CAAC,CAAC;YAEH,kBAAkB,GAAQ;gBACxB,MAAM,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACjB,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,IAAI,KAAK,GAAG,CAAC,CAAC;gBACd,OAAO,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC,KAAK,IAAI,EAAE,CAAC;oBAC1D,KAAK,EAAE,CAAC;oBACR,SAAS,EAAE,CAAC;gBACd,CAAC;gBACD,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;gBAEnC,IAAI,MAAM,GAAG,CAAC,CAAC;gBACf,SAAS,EAAE,CAAC;gBACZ,OAAO,QAAQ,CAAC,aAAa,CAAC,iBAAiB,CAAC,KAAK,IAAI,EAAE,CAAC;oBAC1D,MAAM,EAAE,CAAC;oBACT,SAAS,EAAE,CAAC;gBACd,CAAC;gBAED,MAAM,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;YACjC,CAAC;YAED,EAAE,CAAC,oBAAoB,EAAE;gBACvB,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC3D,QAAQ,CAAC,8BAAc,CAAC,CAAC;YAC3B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,sBAAsB,EAAE;gBACzB,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC3D,QAAQ,CAAC,gCAAgB,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,+CAA+C,EAAE;gBAClD,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,kBAAkB,CAAC,KAAK,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,4DAA4D,EAAE;gBAC/D,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBAEpB,6BAA6B;gBAC7B,oBAAoB,CAAC,YAAY,CAAC,CAAC;gBACnC,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBAE1B,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrB,kBAAkB,CAAC,KAAK,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,2DAA2D,EAAE;gBAC9D,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBAEpB,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,eAAe,CAAC,CAAC;gBACtC,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBAE1B,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrB,kBAAkB,CAAC,IAAI,CAAC,CAAC;gBAEzB,YAAY,EAAE,CAAC;gBACf,kBAAkB,CAAC,KAAK,CAAC,CAAC;YAC5B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,mDAAmD,EAAE;gBACtD,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,qBAAqB,CAAC,KAAK,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,sDAAsD,EAAE;gBACzD,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBAEpB,6BAA6B;gBAC7B,oBAAoB,CAAC,YAAY,CAAC,CAAC;gBACnC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrB,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAC9B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,+DAA+D,EAAE;gBAClE,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBAEpB,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,eAAe,CAAC,CAAC;gBACtC,qBAAqB,CAAC,KAAK,CAAC,CAAC;gBAE7B,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrB,qBAAqB,CAAC,IAAI,CAAC,CAAC;gBAE5B,YAAY,EAAE,CAAC;gBACf,qBAAqB,CAAC,KAAK,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,UAAU,EAAE;gBACb,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,KAAK,CAAC,CAAC;gBAEpB,6BAA6B;gBAC7B,oBAAoB,CAAC,YAAY,CAAC,CAAC;gBACnC,kBAAkB,CAAC,KAAK,CAAC,CAAC;gBAE1B,SAAS,EAAE,CAAC;gBACZ,oBAAoB,CAAC,eAAe,CAAC,CAAC;gBAEtC,aAAa,CAAC,KAAK,CAAC,CAAC;gBACrB,kBAAkB,CAAC,IAAI,CAAC,CAAC;gBACzB,YAAY,EAAE,CAAC;gBAEf,IAAM,MAAM,GAAG,eAAe,CAAC,KAAK,CAAC,IAAI,CAAC,UAAW,CAAC;gBACtD,IAAM,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;gBAC7C,MAAM,CAAC,UAAU,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;gBAEvE,oBAAoB,CAAC,gBAAgB,CAAC,CAAC;YACzC,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,cAAc,EAAE;gBACjB,2CAA2C;gBAC3C,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;gBACnB,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,CAAC;gBAC3D,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAC5B,YAAY,CAAC,MAAM,CAAC,CAAC;gBACrB,aAAa,CAAC,SAAS,CAAC,CAAC;gBAEzB,eAAe,EAAE,CAAC;gBAElB,SAAS,EAAE,CAAC;gBACZ,iEAAiE;gBACjE,oBAAoB,CAAC,aAAa,CAAC,CAAC;gBAEpC,SAAS,EAAE,CAAC;gBACZ,yDAAyD;gBACzD,gBAAgB,EAAE,CAAC;YACrB,CAAC,CAAC,CAAC;YAEH,EAAE,CAAC,qBAAqB,EAAE;gBACxB,MAAM,CAAC,IAAI,CAAC,8BAAc,CAAC,CAAC;gBAE5B,eAAe,EAAE,CAAC;gBAClB,YAAY,CAAC,KAAK,CAAC,CAAC;gBACpB,oBAAoB,CAAC,iBAAiB,CAAC,CAAC;YAC1C,CAAC,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC","file":"dialog-search-replace-test.js","sourcesContent":["/**\n * @author Louis-Dominique Dubeau\n * @license MPL 2.0\n * @copyright Mangalam Research Center for Buddhist Languages\n */\nimport { CaretManager } from \"wed/caret-manager\";\nimport { DLoc, DLocRange } from \"wed/dloc\";\nimport { DialogSearchReplace, Direction } from \"wed/gui/dialog-search-replace\";\nimport { Key } from \"wed/key\";\nimport { SEARCH_BACKWARDS, SEARCH_FORWARD } from \"wed/key-constants\";\nimport { Editor } from \"wed/wed\";\n\nimport * as globalConfig from \"../../base-config\";\n\nimport { EditorSetup } from \"../../wed-test-util\";\n\nconst expect = chai.expect;\n\ndescribe(\"dialog-search-replace\", () => {\n  let setup: EditorSetup;\n  let editor: Editor;\n  let guiRoot: HTMLElement;\n  let dataRoot: Document;\n  let docScope: DLocRange;\n  let caretManager: CaretManager;\n\n  let ps: Element[];\n  let firstBodyP: Element;\n  let firstBodyPLocation: DLoc;\n  let pFiveFirstThree: DLocRange;\n  let pFiveFirstFour: DLocRange;\n  let pSevenFirstThree: DLocRange;\n  let firstABCText: DLocRange;\n  let firstABCDText: DLocRange;\n  let firstABCAttribute: DLocRange;\n  let firstABCDAttribute: DLocRange;\n  let secondABCAttribute: DLocRange;\n  let titleBCD: DLocRange;\n  let titleABCD: DLocRange;\n\n  before(() => {\n    setup = new EditorSetup(\n      \"/base/build/standalone/lib/tests/search_test_data/source_converted.xml\",\n      globalConfig.config,\n      document);\n    ({ editor } = setup);\n    return setup.init();\n  });\n\n  beforeEach(() => {\n    guiRoot = editor.guiRoot;\n    dataRoot = editor.dataRoot;\n    caretManager = editor.caretManager;\n    docScope = editor.caretManager.docDLocRange;\n\n    const title = dataRoot.querySelector(\"title\")!;\n    titleBCD = new DLocRange(\n      caretManager.mustFromDataLocation(title.firstChild!, 1),\n      caretManager.mustFromDataLocation(title.firstChild!, 4));\n    titleABCD = new DLocRange(\n      caretManager.mustFromDataLocation(title.firstChild!, 0),\n      caretManager.mustFromDataLocation(title.firstChild!, 4));\n\n    ps = Array.from(dataRoot.querySelectorAll(\"body p\"));\n    firstBodyP = ps[0];\n    firstBodyPLocation = caretManager.mustFromDataLocation(\n      DLoc.mustMakeDLoc(dataRoot, firstBodyP, 0));\n    caretManager.setCaret(firstBodyPLocation);\n\n    // First 3 text characters in the 5th paragraph (at index 4).\n    const pFiveStart = DLoc.mustMakeDLoc(dataRoot, ps[4].firstChild, 0);\n    pFiveFirstThree = new DLocRange(\n      caretManager.mustFromDataLocation(pFiveStart),\n      caretManager.mustFromDataLocation(pFiveStart.makeWithOffset(3)));\n    expect(pFiveFirstThree.mustMakeDOMRange().toString()).to.equal(\"abc\");\n\n    pFiveFirstFour = new DLocRange(\n      caretManager.mustFromDataLocation(pFiveStart),\n      caretManager.mustFromDataLocation(pFiveStart.makeWithOffset(4)));\n    expect(pFiveFirstFour.mustMakeDOMRange().toString()).to.equal(\"abcd\");\n\n    const pSevenStart = DLoc.mustMakeDLoc(dataRoot, ps[6].firstChild, 0);\n    pSevenFirstThree = new DLocRange(\n      caretManager.mustFromDataLocation(pSevenStart),\n      caretManager.mustFromDataLocation(pSevenStart.makeWithOffset(3)));\n    expect(pSevenFirstThree.mustMakeDOMRange().toString()).to.equal(\"abc\");\n\n    // This is the first \"abc\" found when doing a TEXT search.\n    firstABCText = new DLocRange(\n      caretManager.mustFromDataLocation(ps[3].firstChild!.firstChild!, 0),\n      caretManager.mustFromDataLocation(ps[3].lastChild!, 1));\n\n    // This is the first \"abcd\" found when doing a TEXT search.\n    firstABCDText = new DLocRange(\n      caretManager.mustFromDataLocation(ps[3].firstChild!.firstChild!, 0),\n      caretManager.mustFromDataLocation(ps[3].lastChild!, 2));\n\n    const rend = ps[7].getAttributeNode(\"rend\");\n    firstABCAttribute = new DLocRange(\n      caretManager.mustFromDataLocation(rend, 0),\n      caretManager.mustFromDataLocation(rend, 3));\n\n    firstABCDAttribute = new DLocRange(\n      caretManager.mustFromDataLocation(rend, 0),\n      caretManager.mustFromDataLocation(rend, 4));\n\n    secondABCAttribute = new DLocRange(\n      caretManager.mustFromDataLocation(rend, 4),\n      caretManager.mustFromDataLocation(rend, 7));\n  });\n\n  afterEach(() => {\n    // Make sure there is no dialog after each test.\n    expect(document.querySelector(\".modal .in\")).to.be.null;\n    setup.reset();\n  });\n\n  after(() => {\n    setup.restore();\n    // tslint:disable-next-line:no-any\n    (editor as any) = undefined;\n  });\n\n  function makeSearch(direction: Direction): DialogSearchReplace {\n    // tslint:disable-next-line:no-any\n    return new DialogSearchReplace(editor, (editor as any).scroller, direction);\n  }\n\n  function checkHighlightRanges(range: DLocRange): void {\n    const highlights = document.querySelectorAll(\"._wed_highlight\")!;\n    expect(highlights).to.have.property(\"length\").greaterThan(0);\n    let highlightRect = highlights[0].getBoundingClientRect();\n    const rangeRect =\n      range.mustMakeDOMRange().nativeRange.getBoundingClientRect();\n\n    // The highlights are built as a series of rectangles. Checking each and\n    // every rectangle would be onerous. We check the start and end of the\n    // range.\n\n    // Rounding can make the boundaries vary a bit.\n    expect(highlightRect, \"correct top\").to.have.deep.property(\"top\")\n      .closeTo(rangeRect.top, 3);\n    expect(highlightRect, \"correct left\").to.have.deep.property(\"left\")\n      .closeTo(rangeRect.left, 3);\n\n    highlightRect = highlights[highlights.length - 1].getBoundingClientRect();\n    expect(highlightRect, \"correct bottom\").to.have.deep.property(\"bottom\")\n      .closeTo(rangeRect.bottom, 3);\n    expect(highlightRect, \"correct right\").to.have.deep.property(\"right\")\n      .closeTo(rangeRect.right, 3);\n  }\n\n  function checkNoHighlight(): void {\n      expect(document.querySelector(\"._wed_highlight\")).to.be.null;\n  }\n\n  function closeDialog(): void {\n    const close = document.querySelector(\".modal.in .close\") as HTMLElement;\n    close.click();\n  }\n\n  function typeInSearch(text: string): void {\n    const search = document\n      .querySelector(\".modal.in input[name=search]\") as HTMLInputElement;\n    search.value = text;\n    $(search).trigger(\"input\");\n  }\n\n  function typeInReplace(text: string): void {\n    const field = document\n      .querySelector(\".modal.in input[name=replace]\") as HTMLInputElement;\n    field.value = text;\n    $(field).trigger(\"input\");\n  }\n\n  function clearReplace(): void {\n    const field = document\n      .querySelector(\".modal.in input[name=replace]\") as HTMLInputElement;\n    field.value = \"\";\n    $(field).trigger(\"input\");\n  }\n\n  function clickFind(): void {\n    const find = document\n      .querySelector(\".modal.in [data-bb-handler=find]\") as HTMLButtonElement;\n    find.click();\n  }\n\n  function clickReplace(): void {\n    const button =\n      (document.querySelector(\".modal.in [data-bb-handler=replaceFind]\") as\n       HTMLButtonElement);\n    button.click();\n  }\n\n  function clickReplaceAll(): void {\n    const button =\n      (document.querySelector(\".modal.in [data-bb-handler=replaceAll]\") as\n       HTMLButtonElement);\n    button.click();\n  }\n\n  function clickBackwards(): void {\n    const button =\n      (document.querySelector(\".modal.in [name=direction][value=backwards]\") as\n       HTMLButtonElement);\n    button.click();\n  }\n\n  function checkReplaceButton(enabled: boolean): void {\n    const button =\n      (document.querySelector(\".modal.in [data-bb-handler=replaceFind]\") as\n       HTMLButtonElement);\n    expect(button).to.have.property(\"disabled\").equal(!enabled);\n  }\n\n  function checkReplaceAllButton(enabled: boolean): void {\n    const button =\n      (document.querySelector(\".modal.in [data-bb-handler=replaceAll]\") as\n       HTMLButtonElement);\n    expect(button).to.have.property(\"disabled\").equal(!enabled);\n  }\n\n  function clickAttributes(): void {\n    const button =\n      (document.querySelector(\".modal.in [name=context][value=attributes]\") as\n       HTMLButtonElement);\n    button.click();\n  }\n\n  describe(\"DialogSearchReplace\", () => {\n\n    beforeEach(() => {\n      checkNoHighlight();\n    });\n\n    afterEach(() => {\n      closeDialog();\n    });\n\n    it(\"can be built\", () => {\n      makeSearch(Direction.FORWARD);\n    });\n\n    it(\"updates the highlight when the user types\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n      checkHighlightRanges(firstABCText);\n    });\n\n    it(\"searches forward\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n      checkHighlightRanges(firstABCText);\n      clickFind();\n      checkHighlightRanges(pFiveFirstThree);\n    });\n\n    it(\"searches backwards\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n      checkHighlightRanges(firstABCText);\n      clickFind();\n      checkHighlightRanges(pFiveFirstThree);\n      clickBackwards();\n      clickFind();\n      checkHighlightRanges(firstABCText);\n    });\n\n    it(\"removes the highlight when there is no match\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abcNO MATCH\");\n      checkNoHighlight();\n    });\n\n    function rollTest(key: Key): void {\n      editor.type(key);\n      typeInSearch(\"abc\");\n      let count = 0;\n      while (document.querySelector(\"._wed_highlight\") !== null) {\n        count++;\n        clickFind();\n      }\n      expect(count).to.be.greaterThan(0);\n\n      let count2 = 0;\n      clickFind();\n      while (document.querySelector(\"._wed_highlight\") !== null) {\n        count2++;\n        clickFind();\n      }\n\n      expect(count2).to.equal(count);\n    }\n\n    it(\"rolls over forward\", () => {\n      editor.caretManager.setCaret(editor.caretManager.minCaret);\n      rollTest(SEARCH_FORWARD);\n    });\n\n    it(\"rolls over backwards\", () => {\n      editor.caretManager.setCaret(editor.caretManager.maxCaret);\n      rollTest(SEARCH_BACKWARDS);\n    });\n\n    it(\"starts with a replace button that is disabled\", () => {\n      editor.type(SEARCH_FORWARD);\n      checkReplaceButton(false);\n    });\n\n    it(\"keeps the replace button disabled if the hit is ill-formed\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n\n      // This is an ill-formed hit.\n      checkHighlightRanges(firstABCText);\n      checkReplaceButton(false);\n\n      typeInReplace(\"foo\");\n      checkReplaceButton(false);\n    });\n\n    it(\"enables the replace button if the replace field is filled\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n\n      clickFind();\n      checkHighlightRanges(pFiveFirstThree);\n      checkReplaceButton(false);\n\n      typeInReplace(\"foo\");\n      checkReplaceButton(true);\n\n      clearReplace();\n      checkReplaceButton(false);\n    });\n\n    it(\"starts with a replace all button that is disabled\", () => {\n      editor.type(SEARCH_FORWARD);\n      checkReplaceAllButton(false);\n    });\n\n    it(\"enables replace button even if the hit is ill-formed\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n\n      // This is an ill-formed hit.\n      checkHighlightRanges(firstABCText);\n      typeInReplace(\"foo\");\n      checkReplaceAllButton(true);\n    });\n\n    it(\"enables the replace all button if the replace field is filled\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n\n      clickFind();\n      checkHighlightRanges(pFiveFirstThree);\n      checkReplaceAllButton(false);\n\n      typeInReplace(\"foo\");\n      checkReplaceAllButton(true);\n\n      clearReplace();\n      checkReplaceAllButton(false);\n    });\n\n    it(\"replaces\", () => {\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abc\");\n\n      // This is an ill-formed hit.\n      checkHighlightRanges(firstABCText);\n      checkReplaceButton(false);\n\n      clickFind();\n      checkHighlightRanges(pFiveFirstThree);\n\n      typeInReplace(\"foo\");\n      checkReplaceButton(true);\n      clickReplace();\n\n      const parent = pFiveFirstThree.start.node.parentNode!;\n      const dataParent = editor.toDataNode(parent);\n      expect(dataParent).to.have.property(\"textContent\").equal(\"foodefghij\");\n\n      checkHighlightRanges(pSevenFirstThree);\n    });\n\n    it(\"replaces all\", function (): void {\n      // tslint:disable-next-line:no-invalid-this\n      this.timeout(4000);\n      editor.caretManager.setCaret(editor.caretManager.minCaret);\n      editor.type(SEARCH_FORWARD);\n      typeInSearch(\"abcd\");\n      typeInReplace(\"fnarble\");\n\n      clickReplaceAll();\n\n      clickFind();\n      // This is a hit that cannot be replaced because it is malformed.\n      checkHighlightRanges(firstABCDText);\n\n      clickFind();\n      // Everything else was replaced, so we have no more hits.\n      checkNoHighlight();\n    });\n\n    it(\"searches attributes\", () => {\n      editor.type(SEARCH_FORWARD);\n\n      clickAttributes();\n      typeInSearch(\"abc\");\n      checkHighlightRanges(firstABCAttribute);\n    });\n  });\n});\n"]}